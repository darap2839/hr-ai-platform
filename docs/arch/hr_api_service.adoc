= HR Platform — Сервис API
:toc:
:toclevels: 3
:sectnums:

Документ описывает структуру и назначение компонентов сервиса hr_api_service.

== 1. Назначение сервиса

Сервис API служит шлюзом между фронтендом (hr_web_service) и внутренними сервисами платформы HR AI.
Основные функции:

* Приём REST-запросов от фронтенда.
* Маршрутизация запросов к соответствующим сервисам (ETL, Job, Matching, Analytics).
* Агрегация и стандартизация данных для клиентов.
* Аутентификация и авторизация пользователей (при необходимости).

== 2. Архитектура и компоненты

[source,mermaid]
----
graph TD
    gateway[API Gateway] --> auth[Authentication & Authorization]
    gateway --> validate[Validation & Serialization]
    auth --> router[Request Router]
    validate --> router
    router --> clients[Integration Clients]
----

=== 2.1 API Gateway

* Точка входа для всех HTTP-запросов.
* Перенаправляет запросы на внутренние обработчики.

=== 2.2 Authentication & Authorization

* Проверяет токены или сессии пользователей.
* Ограничивает доступ к ресурсам по ролям и правам.
* Генерирует ошибки 401/403 при недопустимом доступе.

=== 2.3 Validation & Serialization

* Валидирует входящие JSON-запросы на соответствие схемам.
* Сериализует данные в объекты доменной модели (`hr_domain_models`) и обратно.
* Обрабатывает ошибки валидации и возвращает структурированные сообщения клиенту.

=== 2.4 Request Router

* Основной контроллер маршрутизации запросов.
* Решает, какой сервис обрабатывать конкретный тип запроса (ETL, Job, Matching, Analytics).
* Может использовать асинхронные HTTP-клиенты для внутреннего взаимодействия.

=== 2.5 Integration Clients

* Клиенты для обращения к внутренним сервисам через REST API.
* Формирует корректные запросы и обрабатывает ответы.
* Поддерживает таймауты, повторные попытки и кэширование при необходимости.

== 3. Потоки данных

* Вход: HTTP REST-запросы от hr_web_service.
* Внутренние маршруты: распределение запросов к hr_etl_service, hr_job_service, hr_matching_service, hr_analytics_service.
* Выход: стандартизированные JSON-ответы клиенту.

== 4. Роли сервиса в системе

Сервис hr_api_service:

* Получает: запросы от фронтенда.
* Отдаёт: запросы внутренним сервисам и ответы фронтенду.
* Не хранит данные, кроме временного кэша или сессий.
